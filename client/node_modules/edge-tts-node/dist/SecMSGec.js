"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateSecMsGecToken = generateSecMsGecToken;
exports.generateSecMSGecParam = generateSecMSGecParam;
const node_crypto_1 = require("node:crypto");
const WINDOWS_FILE_TIME_EPOCH = 11644473600n;
function generateSecMsGecToken(token) {
    const ticks = BigInt(Math.floor(Date.now() / 1000) + Number(WINDOWS_FILE_TIME_EPOCH)) *
        10000000n;
    const roundedTicks = ticks - (ticks % 3000000000n);
    const strToHash = `${roundedTicks}${token}`;
    const hash = (0, node_crypto_1.createHash)("sha256");
    hash.update(strToHash, "ascii");
    return hash.digest("hex").toUpperCase();
}
function generateSecMSGecParam(token) {
    const version = "1-130.0.2849.68";
    const gec = generateSecMsGecToken(token);
    return `&Sec-MS-GEC=${gec}&Sec-MS-GEC-Version=${version}`;
}
